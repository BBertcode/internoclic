<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corticoïdes</title>
    <link href="style.css", rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Pixelify+Sans:wght@400..700&family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
        
        <script>
            function genererOrdonnance() {
                let doseInitiale = parseFloat(document.getElementById("dose_initiale").value);
                let dureeSemaines = parseInt(document.getElementById("duree_semaines").value);
                let premierPalierDuree = parseInt(document.getElementById("premier_palier_duree").value);
                let dateDebut = document.getElementById("date_debut").value;
    
                let paliers = [80, 70, 60, 50, 40, 30, 25, 20, 17.5, 15, 12.5, 10, 7.5];
                paliers = paliers.filter(d => d <= doseInitiale);
    
                let dateActuelle = new Date(dateDebut);
    
                if (premierPalierDuree >= dureeSemaines) {
                    alert("La durée du premier palier doit être inférieure à la durée totale de la décroissance.");
                    return;
                }
    
                let semainesRestantes = dureeSemaines - premierPalierDuree;
                let nbPaliersRestants = paliers.length - 1;
                let baseDuree = Math.floor(semainesRestantes / nbPaliersRestants);
                let resteSemaines = semainesRestantes % nbPaliersRestants;
    
                let paliersDuree = Array(resteSemaines).fill(baseDuree + 1)
                    .concat(Array(nbPaliersRestants - resteSemaines).fill(baseDuree))
                    .sort((a, b) => a - b);
    
                let ordonnance = [];
                ordonnance.push("PREDNISONE cp de 20 et 5mg:");
    
                let dateFin = new Date(dateActuelle);
                dateFin.setDate(dateActuelle.getDate() + (premierPalierDuree * 7) - 1);
                ordonnance.push(`- ${paliers[0]} mg le matin pendant ${premierPalierDuree} semaine${premierPalierDuree > 1 ? 's' : ''} (du ${dateActuelle.toLocaleDateString('fr-FR')} au ${dateFin.toLocaleDateString('fr-FR')}),`);
                
                dateActuelle = new Date(dateFin);
                dateActuelle.setDate(dateFin.getDate() + 1);
    
                for (let i = 1; i < paliers.length; i++) {
                    let duree = paliersDuree[i - 1];
                    if (duree > 0) {
                        let dateDebutPalier = new Date(dateActuelle);
                        dateFin = new Date(dateDebutPalier);
                        dateFin.setDate(dateDebutPalier.getDate() + (duree * 7) - 1);
                        ordonnance.push(`- puis ${paliers[i]} mg le matin pendant ${duree} semaine${duree > 1 ? 's' : ''} (du ${dateDebutPalier.toLocaleDateString('fr-FR')} au ${dateFin.toLocaleDateString('fr-FR')}),`);
                        
                        dateActuelle = new Date(dateFin);
                        dateActuelle.setDate(dateFin.getDate() + 1);
                    }
                }
    
                ordonnance.push(`- puis 5 mg le matin jusqu'à la prochaine consultation (à partir du ${dateActuelle.toLocaleDateString('fr-FR')}).`);
                ordonnance.push("NE JAMAIS ARRÊTER SANS AVIS MÉDICAL");
                ordonnance.push("\nZYMAD 50 000 UI : 1 ampoule à boire une fois par mois");
    
                document.getElementById("resultat").innerText = ordonnance.join("\n");
            }
    
            function copierOrdonnance() {
                let ordonnance = document.getElementById("resultat").innerText;
                navigator.clipboard.writeText(ordonnance).then(() => {
                    alert("Ordonnance copiée dans le presse-papier.");
                });
            }
    
            window.onload = function() {
                let today = new Date().toISOString().split('T')[0];
                document.getElementById("dose_initiale").value = 60;
                document.getElementById("duree_semaines").value = 13;
                document.getElementById("premier_palier_duree").value = 3;
                document.getElementById("date_debut").value = today;
            };
        </script>
        
</head>
<body>
    <header>
        <a href="index.html">
            <img src="Images/logo3.png" alt="logo InternoClic"/>  
        </a>
        <h1>InternoClic</h1>
    </header>

    <main class="ordo_liste">  
        <h1>Corticothérapie</h1>
        <div class="ordo1">
            <h3 class="titre-ordo">Générateur d'Ordonnance de corticothérapie</h3>
            <label for="dose_initiale">Dose initiale (mg/jour) :</label>
            <input type="number" id="dose_initiale"><br>
            <label for="duree_semaines">Durée de décroissance (semaines) :</label>
            <input type="number" id="duree_semaines"><br>
            <label for="premier_palier_duree">Durée du premier palier (semaines) :</label>
            <input type="number" id="premier_palier_duree"><br>
            <label for="date_debut">Date de début :</label>
            <input type="date" id="date_debut"><br>
            <button onclick="genererOrdonnance()">Générer</button>
            <button onclick="copierOrdonnance(this)">Copier</button>
            <pre id="resultat"></pre>
        </div>
        <div class="ordo1">
            <h3 class="titre-ordo">Information patient</h3>
            <div class="ordo2">
                <li><a target="_blank" href="https://www.grio.org/documents/page610/questionnaire-alimentation-calcium.pdf">Questionnaire apports calciques</a></li>
                <li><a target="_blank" href="https://drive.google.com/file/d/1y16tjBdct3_ijG_83DurzBcMMKI0l9XZ/view">Triptyque alimentation et corticoïdes</a></li>
                <li><a target="_blank" href="https://www.fai2r.org/wp-content/uploads/2020/01/FAI2R-Corticotherapie_YMP-2020.pdf">Corticothérapie, les médecins répondent à vos questions</a></li>
            </div>

        </div>
    </main>
      

    <footer>
        <a href="index.html">Page d'accueil</a>
    </footer>
</body>
</html>
